{"version":3,"sources":["webpack:///./src/views/admin-users/Form.vue?336e","webpack:///src/views/admin-users/Form.vue","webpack:///./src/views/admin-users/Form.vue?4de9","webpack:///./src/views/admin-users/Form.vue","webpack:///./src/components/LzForm/FormHelper.js","webpack:///./src/api/admin-perms.js","webpack:///./src/api/admin-roles.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","scopedSlots","_u","key","fn","proxy","attrs","ref","getData","onSubmit","errors","form","editMode","on","$event","model","value","callback","$$v","$set","expression","_l","i","id","name","staticRenderFns","components","FilePicker","LzForm","mixins","data","username","password","password_confirmation","roles","permissions","avatar","methods","component","provide","view","formField","idField","computed","resourceId","$route","params","created","backupForm","getResourceId","formBak","JSON","parse","stringify","$data","fillForm","assignExists","getAdminPerms","Request","get","storeAdminPerm","post","updateAdminPerm","put","editAdminPerm","getAdminRoles","storeAdminRole","updateAdminRole","editAdminRole","createAdminRole"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACE,YAAYN,EAAIO,GAAG,CAAC,CAACC,IAAI,SAASC,GAAG,WAAW,MAAO,CAACL,EAAG,oBAAoBM,OAAM,MAAS,CAACN,EAAG,SAAS,CAACO,MAAM,CAAC,KAAO,OAAO,QAAU,WAAW,CAACP,EAAG,UAAU,CAACQ,IAAI,OAAOD,MAAM,CAAC,WAAWX,EAAIa,QAAQ,OAASb,EAAIc,SAAS,OAASd,EAAIe,OAAO,KAAOf,EAAIgB,KAAK,YAAYhB,EAAIiB,UAAUC,GAAG,CAAC,gBAAgB,SAASC,GAAQnB,EAAIe,OAAOI,GAAQ,cAAc,SAASA,GAAQnB,EAAIgB,KAAKG,KAAU,CAACf,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,KAAK,SAAW,GAAG,KAAO,aAAa,CAACP,EAAG,WAAW,CAACgB,MAAM,CAACC,MAAOrB,EAAIgB,KAAa,SAAEM,SAAS,SAAUC,GAAMvB,EAAIwB,KAAKxB,EAAIgB,KAAM,WAAYO,IAAME,WAAW,oBAAoB,GAAGrB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,KAAK,SAAW,GAAG,KAAO,SAAS,CAACP,EAAG,WAAW,CAACgB,MAAM,CAACC,MAAOrB,EAAIgB,KAAS,KAAEM,SAAS,SAAUC,GAAMvB,EAAIwB,KAAKxB,EAAIgB,KAAM,OAAQO,IAAME,WAAW,gBAAgB,GAAGrB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,KAAK,KAAO,WAAW,CAACP,EAAG,cAAc,CAACO,MAAM,CAAC,IAAM,oBAAoBS,MAAM,CAACC,MAAOrB,EAAIgB,KAAW,OAAEM,SAAS,SAAUC,GAAMvB,EAAIwB,KAAKxB,EAAIgB,KAAM,SAAUO,IAAME,WAAW,kBAAkB,GAAGrB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,KAAK,UAAYX,EAAIiB,SAAS,KAAO,aAAa,CAACb,EAAG,WAAW,CAACO,MAAM,CAAC,KAAO,WAAW,aAAe,gBAAgBS,MAAM,CAACC,MAAOrB,EAAIgB,KAAa,SAAEM,SAAS,SAAUC,GAAMvB,EAAIwB,KAAKxB,EAAIgB,KAAM,WAAYO,IAAME,WAAW,oBAAoB,GAAGrB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,OAAO,UAAYX,EAAIiB,SAAS,KAAO,0BAA0B,CAACb,EAAG,WAAW,CAACO,MAAM,CAAC,KAAO,WAAW,aAAe,gBAAgBS,MAAM,CAACC,MAAOrB,EAAIgB,KAA0B,sBAAEM,SAAS,SAAUC,GAAMvB,EAAIwB,KAAKxB,EAAIgB,KAAM,wBAAyBO,IAAME,WAAW,iCAAiC,GAAGrB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,KAAK,KAAO,UAAU,CAACP,EAAG,YAAY,CAACO,MAAM,CAAC,SAAW,GAAG,YAAc,OAAO,WAAa,GAAG,UAAY,IAAIS,MAAM,CAACC,MAAOrB,EAAIgB,KAAU,MAAEM,SAAS,SAAUC,GAAMvB,EAAIwB,KAAKxB,EAAIgB,KAAM,QAASO,IAAME,WAAW,eAAezB,EAAI0B,GAAI1B,EAAS,OAAE,SAAS2B,GAAG,OAAOvB,EAAG,YAAY,CAACI,IAAImB,EAAEC,GAAGjB,MAAM,CAAC,MAAQgB,EAAEE,KAAK,MAAQF,EAAEC,SAAQ,IAAI,GAAGxB,EAAG,eAAe,CAACO,MAAM,CAAC,MAAQ,KAAK,KAAO,gBAAgB,CAACP,EAAG,YAAY,CAACO,MAAM,CAAC,SAAW,GAAG,YAAc,OAAO,WAAa,GAAG,UAAY,IAAIS,MAAM,CAACC,MAAOrB,EAAIgB,KAAgB,YAAEM,SAAS,SAAUC,GAAMvB,EAAIwB,KAAKxB,EAAIgB,KAAM,cAAeO,IAAME,WAAW,qBAAqBzB,EAAI0B,GAAI1B,EAAe,aAAE,SAAS2B,GAAG,OAAOvB,EAAG,YAAY,CAACI,IAAImB,EAAEC,GAAGjB,MAAM,CAAC,MAAQgB,EAAEE,KAAK,MAAQF,EAAEC,SAAQ,IAAI,IAAI,IAAI,IAAI,IAClgFE,EAAkB,G,8FCoFtB,GACED,KAAM,OACNE,WAAY,CACVC,WAAJ,OACIC,OAAJ,QAEEC,OAAQ,CACV,QAEEC,KATF,WAUI,MAAO,CACLnB,KAAM,CACJoB,SAAU,GACVP,KAAM,GACNQ,SAAU,GACVC,sBAAuB,GACvBC,MAAO,GACPC,YAAa,GACbC,OAAQ,IAEV1B,OAAQ,GACRwB,MAAO,GACPC,YAAa,KAGjBE,QAAS,CACP,SADJ,2JAEA,cAFA,gCAGA,0CAHA,6CAKA,0BALA,wGAQI,QARJ,qKAWA,cAXA,gCAYA,gCAZA,gBAYA,EAZA,EAYA,KACA,4BAbA,wCAeA,iBAfA,iBAeA,EAfA,EAeA,KAfA,QAkBA,mBACA,+BAnBA,2GC9G6S,I,YCOzSC,EAAY,eACd,EACA5C,EACA+B,GACA,EACA,KACA,KACA,MAIa,aAAAa,E,6CClBf,gBAEe,QACbC,QADa,WAEX,MAAO,CACLC,KAAM5C,OAGVkC,KANa,WAOX,MAAO,CAILW,UAAW,OAIXC,QAAS,OAGbC,SAAU,CACR/B,SADQ,WAEN,QAAShB,KAAKgD,YAEhBA,WAJQ,WAKN,OAAOhD,KAAKiD,OAAOC,OAAOlD,KAAK8C,WAGnCK,QA1Ba,WA2BXnD,KAAKoD,cAEPX,QAAS,CACPY,cADO,WACmB,IAAZ9C,EAAY,uDAAN,KAClB,OAAOP,KAAKiD,OAAOC,OAAO3C,IAK5B6C,WAPO,WAQLpD,KAAKsD,QAAUC,KAAKC,MAAMD,KAAKE,UAAUzD,KAAK0D,MAAM1D,KAAK6C,cAO3Dc,SAfO,SAeEzB,GACPlC,KAAK0D,MAAM1D,KAAK6C,WAAae,eAAa5D,KAAK0D,MAAM1D,KAAK6C,WAAYX,O,kCC/C5E,wJAEO,SAAS2B,IAA2B,IAAbX,EAAa,uDAAJ,GACrC,OAAOY,OAAQC,IAAI,oBAAqB,CACtCb,WAIG,SAASc,EAAe9B,GAC7B,OAAO4B,OAAQG,KAAK,oBAAqB/B,GAOpC,SAASgC,EAAgBvC,EAAIO,GAClC,OAAO4B,OAAQK,IAAR,4BAAiCxC,GAAMO,GAGzC,SAASkC,EAAczC,GAC5B,OAAOmC,OAAQC,IAAR,4BAAiCpC,EAAjC,Y,kCCrBT,0LAEO,SAAS0C,IAA2B,IAAbnB,EAAa,uDAAJ,GACrC,OAAOY,OAAQC,IAAI,cAAe,CAAEb,WAG/B,SAASoB,EAAepC,GAC7B,OAAO4B,OAAQG,KAAK,cAAe/B,GAO9B,SAASqC,EAAgB5C,EAAIO,GAClC,OAAO4B,OAAQK,IAAR,sBAA2BxC,GAAMO,GAGnC,SAASsC,EAAc7C,GAC5B,OAAOmC,OAAQC,IAAR,sBAA2BpC,EAA3B,UAGF,SAAS8C,IACd,OAAOX,OAAQC,IAAI","file":"js/chunk-0080832e.2744faf8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('content-header')]},proxy:true}])},[_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"center\"}},[_c('lz-form',{ref:\"form\",attrs:{\"get-data\":_vm.getData,\"submit\":_vm.onSubmit,\"errors\":_vm.errors,\"form\":_vm.form,\"edit-mode\":_vm.editMode},on:{\"update:errors\":function($event){_vm.errors=$event},\"update:form\":function($event){_vm.form=$event}}},[_c('el-form-item',{attrs:{\"label\":\"账号\",\"required\":\"\",\"prop\":\"username\"}},[_c('el-input',{model:{value:(_vm.form.username),callback:function ($$v) {_vm.$set(_vm.form, \"username\", $$v)},expression:\"form.username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"姓名\",\"required\":\"\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"头像\",\"prop\":\"avatar\"}},[_c('file-picker',{attrs:{\"ext\":\"jpg,gif,png,jpeg\"},model:{value:(_vm.form.avatar),callback:function ($$v) {_vm.$set(_vm.form, \"avatar\", $$v)},expression:\"form.avatar\"}})],1),_c('el-form-item',{attrs:{\"label\":\"密码\",\"required\":!_vm.editMode,\"prop\":\"password\"}},[_c('el-input',{attrs:{\"type\":\"password\",\"autocomplete\":\"new-password\"},model:{value:(_vm.form.password),callback:function ($$v) {_vm.$set(_vm.form, \"password\", $$v)},expression:\"form.password\"}})],1),_c('el-form-item',{attrs:{\"label\":\"确认密码\",\"required\":!_vm.editMode,\"prop\":\"password_confirmation\"}},[_c('el-input',{attrs:{\"type\":\"password\",\"autocomplete\":\"new-password\"},model:{value:(_vm.form.password_confirmation),callback:function ($$v) {_vm.$set(_vm.form, \"password_confirmation\", $$v)},expression:\"form.password_confirmation\"}})],1),_c('el-form-item',{attrs:{\"label\":\"角色\",\"prop\":\"roles\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"placeholder\":\"选择角色\",\"filterable\":\"\",\"clearable\":\"\"},model:{value:(_vm.form.roles),callback:function ($$v) {_vm.$set(_vm.form, \"roles\", $$v)},expression:\"form.roles\"}},_vm._l((_vm.roles),function(i){return _c('el-option',{key:i.id,attrs:{\"label\":i.name,\"value\":i.id}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"权限\",\"prop\":\"permissions\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"placeholder\":\"选择权限\",\"filterable\":\"\",\"clearable\":\"\"},model:{value:(_vm.form.permissions),callback:function ($$v) {_vm.$set(_vm.form, \"permissions\", $$v)},expression:\"form.permissions\"}},_vm._l((_vm.permissions),function(i){return _c('el-option',{key:i.id,attrs:{\"label\":i.name,\"value\":i.id}})}),1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-card>\r\n    <template #header>\r\n      <content-header/>\r\n    </template>\r\n    <el-row type=\"flex\" justify=\"center\">\r\n      <lz-form\r\n        ref=\"form\"\r\n        :get-data=\"getData\"\r\n        :submit=\"onSubmit\"\r\n        :errors.sync=\"errors\"\r\n        :form.sync=\"form\"\r\n        :edit-mode=\"editMode\"\r\n      >\r\n        <el-form-item label=\"账号\" required prop=\"username\">\r\n          <el-input v-model=\"form.username\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"姓名\" required prop=\"name\">\r\n          <el-input v-model=\"form.name\"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"头像\" prop=\"avatar\">\r\n          <file-picker\r\n            v-model=\"form.avatar\"\r\n            ext=\"jpg,gif,png,jpeg\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\" :required=\"!editMode\" prop=\"password\">\r\n          <el-input\r\n            v-model=\"form.password\"\r\n            type=\"password\"\r\n            autocomplete=\"new-password\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"确认密码\" :required=\"!editMode\" prop=\"password_confirmation\">\r\n          <el-input\r\n            v-model=\"form.password_confirmation\"\r\n            type=\"password\"\r\n            autocomplete=\"new-password\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"角色\" prop=\"roles\">\r\n          <el-select\r\n            v-model=\"form.roles\"\r\n            multiple\r\n            placeholder=\"选择角色\"\r\n            filterable\r\n            clearable\r\n          >\r\n            <el-option\r\n              v-for=\"i of roles\"\r\n              :key=\"i.id\"\r\n              :label=\"i.name\"\r\n              :value=\"i.id\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"权限\" prop=\"permissions\">\r\n          <el-select\r\n            v-model=\"form.permissions\"\r\n            multiple\r\n            placeholder=\"选择权限\"\r\n            filterable\r\n            clearable\r\n          >\r\n            <el-option\r\n              v-for=\"i of permissions\"\r\n              :key=\"i.id\"\r\n              :label=\"i.name\"\r\n              :value=\"i.id\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n      </lz-form>\r\n    </el-row>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nimport LzForm from '@c/LzForm'\r\nimport { createAdminUser, editAdminUser, storeAdminUser, updateAdminUser } from '@/api/admin-users'\r\nimport { getAdminRoles } from '@/api/admin-roles'\r\nimport { getAdminPerms } from '@/api/admin-perms'\r\nimport FormHelper from '@c/LzForm/FormHelper'\r\nimport FilePicker from '@c/FilePicker'\r\n\r\nexport default {\r\n  name: 'Form',\r\n  components: {\r\n    FilePicker,\r\n    LzForm,\r\n  },\r\n  mixins: [\r\n    FormHelper,\r\n  ],\r\n  data() {\r\n    return {\r\n      form: {\r\n        username: '',\r\n        name: '',\r\n        password: '',\r\n        password_confirmation: '',\r\n        roles: [],\r\n        permissions: [],\r\n        avatar: '',\r\n      },\r\n      errors: {},\r\n      roles: [],\r\n      permissions: [],\r\n    }\r\n  },\r\n  methods: {\r\n    async onSubmit() {\r\n      if (this.editMode) {\r\n        await updateAdminUser(this.resourceId, this.form)\r\n      } else {\r\n        await storeAdminUser(this.form)\r\n      }\r\n    },\r\n    async getData() {\r\n      let data\r\n\r\n      if (this.editMode) {\r\n        ({ data } = await editAdminUser(this.resourceId))\r\n        this.fillForm(data.admin_user)\r\n      } else {\r\n        ({ data } = await createAdminUser())\r\n      }\r\n\r\n      this.roles = data.roles\r\n      this.permissions = data.permissions\r\n    },\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Form.vue?vue&type=template&id=0ebb8a8f&\"\nimport script from \"./Form.vue?vue&type=script&lang=js&\"\nexport * from \"./Form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { assignExists } from '@/libs/utils'\r\n\r\nexport default {\r\n  provide() {\r\n    return {\r\n      view: this,\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      /**\r\n       * 保存表单数据的键名\r\n       */\r\n      formField: 'form',\r\n      /**\r\n       * 编辑时，路由中的动态值\r\n       */\r\n      idField: 'id',\r\n    }\r\n  },\r\n  computed: {\r\n    editMode() {\r\n      return !!this.resourceId\r\n    },\r\n    resourceId() {\r\n      return this.$route.params[this.idField]\r\n    },\r\n  },\r\n  created() {\r\n    this.backupForm()\r\n  },\r\n  methods: {\r\n    getResourceId(key = 'id') {\r\n      return this.$route.params[key]\r\n    },\r\n    /**\r\n     * 备份表单原始数据，路由切换时，用来重置表单\r\n     */\r\n    backupForm() {\r\n      this.formBak = JSON.parse(JSON.stringify(this.$data[this.formField]))\r\n    },\r\n    /**\r\n     * 填充表单数据\r\n     *\r\n     * @param data\r\n     */\r\n    fillForm(data) {\r\n      this.$data[this.formField] = assignExists(this.$data[this.formField], data)\r\n    },\r\n  },\r\n}\r\n","import Request from '@/plugins/request'\r\n\r\nexport function getAdminPerms(params = {}) {\r\n  return Request.get('admin-permissions', {\r\n    params,\r\n  })\r\n}\r\n\r\nexport function storeAdminPerm(data) {\r\n  return Request.post('admin-permissions', data)\r\n}\r\n\r\nexport function destroyAdminPerm(id) {\r\n  return Request.delete(`admin-permissions/${id}`)\r\n}\r\n\r\nexport function updateAdminPerm(id, data) {\r\n  return Request.put(`admin-permissions/${id}`, data)\r\n}\r\n\r\nexport function editAdminPerm(id) {\r\n  return Request.get(`admin-permissions/${id}/edit`)\r\n}\r\n","import Request from '@/plugins/request'\r\n\r\nexport function getAdminRoles(params = {}) {\r\n  return Request.get('admin-roles', { params })\r\n}\r\n\r\nexport function storeAdminRole(data) {\r\n  return Request.post('admin-roles', data)\r\n}\r\n\r\nexport function destroyAdminRole(id) {\r\n  return Request.delete(`admin-roles/${id}`)\r\n}\r\n\r\nexport function updateAdminRole(id, data) {\r\n  return Request.put(`admin-roles/${id}`, data)\r\n}\r\n\r\nexport function editAdminRole(id) {\r\n  return Request.get(`admin-roles/${id}/edit`)\r\n}\r\n\r\nexport function createAdminRole() {\r\n  return Request.get('admin-roles/create')\r\n}\r\n"],"sourceRoot":""}