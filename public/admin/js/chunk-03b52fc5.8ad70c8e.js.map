{"version":3,"sources":["webpack:///src/components/LzForm/index.vue","webpack:///./src/components/LzForm/index.vue","webpack:///./src/components/LzForm/index.vue?5874","webpack:///./src/components/LzForm/index.vue?5ebe","webpack:///./src/views/admin-roles/Form.vue?465b","webpack:///./src/views/admin-roles/Form.vue?06b1","webpack:///src/views/admin-roles/Form.vue","webpack:///./src/views/admin-roles/Form.vue?0353","webpack:///./src/views/admin-roles/Form.vue","webpack:///./src/components/LzForm/index.vue?0471","webpack:///./src/components/LzForm/FormHelper.js","webpack:///./src/api/admin-perms.js","webpack:///./src/api/admin-roles.js"],"names":["staticRenderFns","name","components","FlexSpacer","inject","view","from","default","data","loading","stay","props","getData","Function","submit","errors","Object","form","submitText","type","String","labelPosition","inDialog","Boolean","createdRedirect","p","length","updatedRedirect","this","$router","back","bind","disableRedirect","disableStay","editMode","computed","realLabelPosition","$store","state","miniWidth","created","copyMethods","methods","Form","m","apply","$refs","arguments","onReset","resetFields","watch","$route","handler","$active","_getData","immediate","render","Array","isArray","defaultSlot","map","helper","replace","slot","h","options","propsData","formItem","model","on","class","style","width","directives","ref","component","_vm","_h","$createElement","_c","_self","scopedSlots","_u","key","fn","proxy","attrs","onSubmit","$event","value","callback","$$v","$set","expression","filterMethod","perms","label","LzForm","mixins","slug","permissions","item","indexOf","query","provide","formField","idField","resourceId","params","backupForm","getResourceId","formBak","JSON","parse","stringify","$data","fillForm","assignExists","getAdminPerms","Request","get","storeAdminPerm","post","updateAdminPerm","id","put","editAdminPerm","getAdminRoles","storeAdminRole","updateAdminRole","editAdminRole","createAdminRole"],"mappings":"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","file":"js/chunk-03b52fc5.8ad70c8e.js","sourcesContent":["<script>\nimport _forIn from 'lodash/forIn'\nimport _get from 'lodash/get'\nimport Form from '@/plugins/element/components/Form'\nimport { getMessage, handleValidateErrors } from '@/libs/utils'\nimport FlexSpacer from '@c/FlexSpacer'\n\nexport default {\n  name: 'LzForm',\n  components: {\n    FlexSpacer,\n  },\n  inject: {\n    // 使用 FormHelper 混入，会自动提供该注入\n    view: {\n      from: 'view',\n      default: null,\n    },\n  },\n  data() {\n    return {\n      loading: false,\n      stay: false,\n    }\n  },\n  props: {\n    getData: Function,\n    submit: Function,\n    errors: Object,\n    form: Object,\n    submitText: {\n      type: String,\n      default: '保存',\n    },\n    labelPosition: String,\n    inDialog: Boolean,\n    createdRedirect: {\n      type: [String, Function],\n      default() {\n        const p = this.$route.path.split('/')\n        return '/' + (p[p.length - 2] || '')\n      },\n    },\n    updatedRedirect: {\n      type: [String, Function],\n      default() {\n        return this.$router.back.bind(this.$router)\n      },\n    },\n    disableRedirect: Boolean,\n    disableStay: Boolean,\n    editMode: Boolean,\n  },\n  computed: {\n    realLabelPosition() {\n      return this.labelPosition || (this.$store.state.miniWidth ? 'top' : 'right')\n    },\n    miniWidth() {\n      return this.$store.state.miniWidth\n    },\n  },\n  created() {\n    this.copyMethods()\n  },\n  methods: {\n    /**\n     * 复制实际 Form 组件的方法, 给外部调用, 并把 this 指向 ElForm 实例\n     */\n    copyMethods() {\n      // 原始 ElForm 和 重写的 Form\n      [Form.extends.methods, Form.methods].forEach(methods => {\n        _forIn(methods, (m, k) => {\n          this[k] = function () {\n            m.apply(this.$refs.form, arguments)\n          }\n        })\n      })\n    },\n    async _getData() {\n      this.loading = true\n      this.view && this.$emit('update:form', this.view.formBak)\n\n      try {\n        this.getData && await this.getData()\n        // 在某些情况下，会出现方法未定义，所以放到 nextTick 中\n        this.$nextTick(() => {\n          this.setInitialValues()\n        })\n      } catch (e) {\n        Promise.reject(e)\n      }\n\n      this.loading = false\n    },\n    async onSubmit() {\n      this.$emit('update:errors', {})\n      try {\n        this.submit && await this.submit()\n\n        this.$message.success(getMessage(this.editMode ? 'updated' : 'created'))\n\n        if (this.stay || this.disableRedirect) {\n          return\n        }\n\n        let redirect = this.editMode ? this.updatedRedirect : this.createdRedirect\n        if (typeof redirect === 'string') {\n          this.$router.push(redirect)\n        } else if (typeof redirect === 'function') {\n          redirect()\n        }\n      } catch (e) {\n        this.$emit('update:errors', handleValidateErrors(e.response))\n        if (_get(e, 'response.status') !== 422) {\n          Promise.reject(e)\n        }\n      }\n    },\n    onReset() {\n      this.$refs.form.resetFields()\n    },\n  },\n  watch: {\n    $route: {\n      handler() {\n        this.$active && this._getData()\n      },\n      immediate: true,\n    },\n  },\n  render(h) {\n    let defaultSlot = this.$slots.default\n    if (Array.isArray(defaultSlot)) {\n      defaultSlot = defaultSlot.map((formItem) => {\n        const options = formItem.componentOptions\n\n        // 如果有 helper props，则生成一个新的 FormItem 替换掉原来的\n        let { helper, label } = options.propsData\n        if (helper) {\n          helper = helper.replace(/\\n/g, '<br>')\n          const labelSlot = h('template', {\n            slot: 'label',\n          }, [\n            (<span>{label}</span>),\n            (\n              <el-tooltip\n                effect=\"dark\"\n                placement=\"top-start\"\n                popper-class={`form-helper-popper ${this.miniWidth ? 'mini-width' : ''}`}\n              >\n                <div slot=\"content\" domPropsInnerHTML={helper}/>\n                <i class=\"ml-1 el-icon-question helper\"/>\n              </el-tooltip>\n            ),\n          ])\n          return h('el-form-item', {\n            props: options.propsData,\n          }, [labelSlot, ...options.children])\n        } else {\n          return formItem\n        }\n      })\n    }\n\n    const stayCheckbox = !this.disableStay && (\n      <el-checkbox\n        vModel={this.stay}\n        title=\"表单提交后，留在此页\"\n      >\n        留在此页\n      </el-checkbox>\n    )\n\n    const footerSlot = this.$slots.footer || (\n      <el-form-item class=\"footer\">\n        <loading-action type=\"primary\" action={this.onSubmit}>{this.submitText}</loading-action>\n        <el-button vOn:click={this.onReset}>重置</el-button>\n        {this.$slots.footerAppend}\n        <flex-spacer/>\n        {stayCheckbox}\n      </el-form-item>\n    )\n\n    // 用 jsx，ElForm 组件的 model props 传不进去，，，\n    return h('el-form', {\n      props: {\n        model: this.form,\n        errors: this.errors,\n        labelPosition: this.realLabelPosition,\n        ...this.$attrs,\n      },\n      on: {\n        ...this.$listeners,\n      },\n      class: {\n        'in-dialog': this.inDialog,\n      },\n      style: {\n        width: this.inDialog ? 'auto' : '800px',\n      },\n      directives: [\n        {\n          name: 'loading',\n          value: this.loading,\n        },\n      ],\n      ref: 'form',\n    }, [defaultSlot, footerSlot])\n  },\n}\n</script>\n\n<style scoped lang=\"scss\">\n@import '~element-ui/packages/theme-chalk/src/common/var';\n\n.footer {\n  ::v-deep {\n    .el-form-item__content {\n      display: flex;\n    }\n  }\n}\n\n.in-dialog {\n  .footer {\n    text-align: right;\n    margin-bottom: 0;\n  }\n}\n\n.helper {\n  color: $--color-primary;\n  border: 2px solid transparent;\n  border-radius: 50%;\n  transition: border-color .3s;\n\n  &:hover {\n    border-color: $--color-primary-light-1;\n  }\n}\n</style>\n\n<style lang=\"scss\">\n.form-helper-popper {\n  max-width: 400px;\n\n  &.mini-width {\n    max-width: 90%;\n  }\n}\n</style>\n","var render, staticRenderFns\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=fb405614&scoped=true&lang=scss&\"\nimport style1 from \"./index.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fb405614\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=1&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=1&lang=scss&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=style&index=0&id=325dd8a3&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=style&index=0&id=325dd8a3&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('content-header')]},proxy:true}])},[_c('el-row',{attrs:{\"type\":\"flex\",\"justify\":\"center\"}},[_c('lz-form',{ref:\"form\",attrs:{\"get-data\":_vm.getData,\"submit\":_vm.onSubmit,\"form\":_vm.form,\"errors\":_vm.errors,\"edit-mode\":_vm.editMode},on:{\"update:form\":function($event){_vm.form=$event},\"update:errors\":function($event){_vm.errors=$event}}},[_c('el-form-item',{attrs:{\"label\":\"标识\",\"required\":\"\",\"prop\":\"slug\"}},[_c('el-input',{model:{value:(_vm.form.slug),callback:function ($$v) {_vm.$set(_vm.form, \"slug\", $$v)},expression:\"form.slug\"}})],1),_c('el-form-item',{attrs:{\"label\":\"名称\",\"required\":\"\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"权限\",\"prop\":\"permissions\"}},[_c('el-transfer',{attrs:{\"filterable\":\"\",\"filter-method\":_vm.filterMethod,\"filter-placeholder\":\"搜索权限\",\"titles\":['待选', '已选'],\"button-texts\":['移除', '选择'],\"data\":_vm.perms,\"props\":{ key: 'id', label: 'name' }},model:{value:(_vm.form.permissions),callback:function ($$v) {_vm.$set(_vm.form, \"permissions\", $$v)},expression:\"form.permissions\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-card>\n    <template #header>\n      <content-header/>\n    </template>\n    <el-row type=\"flex\" justify=\"center\">\n      <lz-form\n        ref=\"form\"\n        :get-data=\"getData\"\n        :submit=\"onSubmit\"\n        :form.sync=\"form\"\n        :errors.sync=\"errors\"\n        :edit-mode=\"editMode\"\n      >\n        <el-form-item label=\"标识\" required prop=\"slug\">\n          <el-input v-model=\"form.slug\"/>\n        </el-form-item>\n        <el-form-item label=\"名称\" required prop=\"name\">\n          <el-input v-model=\"form.name\"/>\n        </el-form-item>\n        <el-form-item label=\"权限\" prop=\"permissions\">\n          <el-transfer\n            filterable\n            :filter-method=\"filterMethod\"\n            filter-placeholder=\"搜索权限\"\n            :titles=\"['待选', '已选']\"\n            :button-texts=\"['移除', '选择']\"\n            v-model=\"form.permissions\"\n            :data=\"perms\"\n            :props=\"{ key: 'id', label: 'name' }\"\n          />\n        </el-form-item>\n      </lz-form>\n    </el-row>\n  </el-card>\n</template>\n\n<script>\nimport LzForm from '@c/LzForm'\nimport { editAdminRole, updateAdminRole, storeAdminRole, createAdminRole } from '@/api/admin-roles'\nimport { getAdminPerms } from '@/api/admin-perms'\nimport FormHelper from '@c/LzForm/FormHelper'\n\nexport default {\n  name: 'Form',\n  components: {\n    LzForm,\n  },\n  mixins: [\n    FormHelper,\n  ],\n  data() {\n    return {\n      form: {\n        slug: '',\n        name: '',\n        permissions: [],\n      },\n      errors: {},\n      perms: [],\n    }\n  },\n  methods: {\n    async getData() {\n      let data\n\n      if (this.editMode) {\n        ({ data } = await editAdminRole(this.resourceId))\n        data.role.permissions = data.role.permissions.map(i => i.id)\n        this.fillForm(data.role)\n      } else {\n        ({ data } = await createAdminRole())\n      }\n\n      this.perms = data.permissions\n    },\n    async onSubmit() {\n      if (this.editMode) {\n        await updateAdminRole(this.resourceId, this.form)\n      } else {\n        await storeAdminRole(this.form)\n      }\n    },\n    filterMethod(query, item) {\n      return item.name.indexOf(query) > -1\n    },\n  },\n}\n</script>\n\n<style scoped lang=\"scss\">\n::v-deep {\n  .el-transfer-panel__body {\n    height: 300px;\n  }\n\n  .el-transfer-panel__list.is-filterable {\n    height: 249px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Form.vue?vue&type=template&id=325dd8a3&scoped=true&\"\nimport script from \"./Form.vue?vue&type=script&lang=js&\"\nexport * from \"./Form.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Form.vue?vue&type=style&index=0&id=325dd8a3&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"325dd8a3\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=fb405614&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=fb405614&scoped=true&lang=scss&\"","import { assignExists } from '@/libs/utils'\n\nexport default {\n  provide() {\n    return {\n      view: this,\n    }\n  },\n  data() {\n    return {\n      /**\n       * 保存表单数据的键名\n       */\n      formField: 'form',\n      /**\n       * 编辑时，路由中的动态值\n       */\n      idField: 'id',\n    }\n  },\n  computed: {\n    editMode() {\n      return !!this.resourceId\n    },\n    resourceId() {\n      return this.$route.params[this.idField]\n    },\n  },\n  created() {\n    this.backupForm()\n  },\n  methods: {\n    getResourceId(key = 'id') {\n      return this.$route.params[key]\n    },\n    /**\n     * 备份表单原始数据，路由切换时，用来重置表单\n     */\n    backupForm() {\n      this.formBak = JSON.parse(JSON.stringify(this.$data[this.formField]))\n    },\n    /**\n     * 填充表单数据\n     *\n     * @param data\n     */\n    fillForm(data) {\n      this.$data[this.formField] = assignExists(this.$data[this.formField], data)\n    },\n  },\n}\n","import Request from '@/plugins/request'\n\nexport function getAdminPerms(params = {}) {\n  return Request.get('admin-permissions', {\n    params,\n  })\n}\n\nexport function storeAdminPerm(data) {\n  return Request.post('admin-permissions', data)\n}\n\nexport function destroyAdminPerm(id) {\n  return Request.delete(`admin-permissions/${id}`)\n}\n\nexport function updateAdminPerm(id, data) {\n  return Request.put(`admin-permissions/${id}`, data)\n}\n\nexport function editAdminPerm(id) {\n  return Request.get(`admin-permissions/${id}/edit`)\n}\n","import Request from '@/plugins/request'\n\nexport function getAdminRoles(params = {}) {\n  return Request.get('admin-roles', { params })\n}\n\nexport function storeAdminRole(data) {\n  return Request.post('admin-roles', data)\n}\n\nexport function destroyAdminRole(id) {\n  return Request.delete(`admin-roles/${id}`)\n}\n\nexport function updateAdminRole(id, data) {\n  return Request.put(`admin-roles/${id}`, data)\n}\n\nexport function editAdminRole(id) {\n  return Request.get(`admin-roles/${id}/edit`)\n}\n\nexport function createAdminRole() {\n  return Request.get('admin-roles/create')\n}\n"],"sourceRoot":""}